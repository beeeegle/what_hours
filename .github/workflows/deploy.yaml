name: web page deploy

on:
  push: 
    branches:
      - main
  workflow_dispatch:

jobs:
  web-page-deploy:
      runs-on: ubuntu-latest
      steps:
          - name: checkout code
            uses: actions/checkout@v2
            
          - name: install package
            run: |
              yarn install
          - name: build
            run: |
              yarn build
        #   - name: upload dist to gh-pages
        #     uses: peaceiris/actions-gh-pages@v3
        #     with:
        #       deploy_key: ${{ secrets.ACTIONS_DEPLOY_KEY }}
        #       publish_dir: ./dist
  deploy:
      # Add a dependency to the build job
      needs: web-page-deploy
      # Grant GITHUB_TOKEN the permissions required to make a Pages deployment
      permissions:
          pages: write      # to deploy to Pages
          id-token: write   # to verify the deployment originates from an appropriate source
      # Deploy to the github-pages environment
      environment:
          name: github-pages
          url: ${{ steps.deployment.outputs.page_url }}
      # Specify runner + deployment step
      runs-on: ubuntu-latest
      steps:
        - name: Deploy to GitHub Pages
          id: deployment
          uses: actions/deploy-pages@v4 # or specific "vX.X.X" version tag for this action